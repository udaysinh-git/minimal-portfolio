---
layout: layout.njk
title: Blog
---

<div class="blog-header">
  <h1>Blog</h1>
  <a href="/rss.xml" class="rss-button" onclick="handleRSSClick(event)">
    <svg
      class="rss-icon"
      width="24"
      height="24"
      viewBox="0 0 24 24"
      fill="none"
      xmlns="http://www.w3.org/2000/svg"
    >
      <path
        d="M4 11a9 9 0 0 1 9 9"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
      />
      <path
        d="M4 4a16 16 0 0 1 16 16"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
      />
      <circle cx="5" cy="19" r="1" fill="currentColor" />
    </svg>
  </a>
</div>

<p>
  Welcome to my blog! Here you will find my latest posts on various topics
  related to software development, AI, and more.
</p>

<ul class="blog-list">
  {% for post in collections.blog %}
  <li
    class="blog-item"
    style="animation-delay: {{ forloop.index0 * 0.1 }}s;"
    onclick="handleBlogClick('{{ post.url }}')"
  >
    <span class="blog-number"></span>
    <a href="{{ post.url }}">{{ post.data.title }}</a> -
    <span class="post-date" data-date="{{ post.data.date }}">
      {{ post.data.date | date("DDD") }}{% if post.data.time %} at {{ post.data.time }}{%
      endif %}
    </span>
    <span
      class="post-views"
      data-slug="{{ post.url | replace('/posts/', '') | replace('/', '') | replace('.html', '') }}"
    >
      <svg
        class="eye-icon"
        width="14"
        height="14"
        viewBox="0 0 24 24"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <path
          d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
        />
        <circle
          cx="12"
          cy="12"
          r="3"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
        />
      </svg>
      <span class="view-count animated-counter">0</span> views
    </span>
    <ul class="tag-list">
      {% for tag in post.data.tags %}
      <li class="tag-item"><a href="/tag/{{ tag | slug }}/">{{ tag }}</a></li>
      {% endfor %}
    </ul>
  </li>
  {% endfor %}
</ul>
<script>
  function handleBlogClick(url) {
    const article = document.querySelector(".post-content")
    if (article) {
      article.classList.add("slide-out-left")
      setTimeout(() => {
        article.classList.remove("slide-out-left")
        article.classList.add("slide-in-right")
        window.location.href = url
      }, 500)
    } else {
      window.location.href = url
    }
  }

  function handleRSSClick(event) {
    event.preventDefault()
    const rssLink = window.location.origin + "/rss.xml"
    navigator.clipboard
      .writeText(rssLink)
      .then(() => {
        showToast("RSS link copied to clipboard!")
        window.open(rssLink, "_blank")
      })
      .catch(() => {
        showToast("Failed to copy RSS link.")
      })
  }

  function showToast(message) {
    const toast = document.querySelector(".theme-toast")
    toast.textContent = message
    toast.classList.add("show")
    setTimeout(() => {
      toast.classList.remove("show")
    }, 3000)
  }

  // Animated counter function
  function animateCounter(element, targetValue, duration = 2000) {
    const startTime = performance.now()
    const startValue = 0
    
    // Add animation classes
    element.classList.add('animating')
    const postViews = element.closest('.post-views')
    if (postViews) {
      postViews.classList.add('animating')
    }
    
    function updateCounter(currentTime) {
      const elapsed = currentTime - startTime
      const progress = Math.min(elapsed / duration, 1)
      
      // Easing function for smooth animation
      const easeOutQuart = 1 - Math.pow(1 - progress, 4)
      const currentValue = Math.floor(startValue + (targetValue - startValue) * easeOutQuart)
      
      element.textContent = currentValue.toLocaleString()
      
      if (progress < 1) {
        requestAnimationFrame(updateCounter)
      } else {
        element.textContent = targetValue.toLocaleString()
        // Remove animation classes after completion
        setTimeout(() => {
          element.classList.remove('animating')
          if (postViews) {
            postViews.classList.remove('animating')
          }
        }, 500)
      }
    }
    
    requestAnimationFrame(updateCounter)
  }

  // Assign numbering from bottom to top
  document.addEventListener("DOMContentLoaded", () => {
    const blogNumbers = document.querySelectorAll(".blog-number")
    const total = blogNumbers.length
    blogNumbers.forEach((elem, index) => {
      elem.textContent = `${total - index}.`
    })

    // Load and display blog view counts with animation
    loadBlogViews()
  })

  // Function to load and display blog view counts with animation
  async function loadBlogViews() {
    try {
      const response = await fetch("/.netlify/functions/blog-views")
      if (response.ok) {
        const data = await response.json()
        const blogViews = data.blogViews || []

        // Update view counts for each blog post with animation
        const viewElements = document.querySelectorAll(".post-views")
        viewElements.forEach((element, index) => {
          const slug = element.getAttribute("data-slug")
          const viewCountElement = element.querySelector(".view-count")

          // Find matching blog view data
          const blogView = blogViews.find((view) => view.slug === slug)
          const targetViews = blogView ? blogView.views : 0
          
          // Start animation after a small delay for each item
          setTimeout(() => {
            animateCounter(viewCountElement, targetViews, 1500)
          }, index * 200) // Stagger the animations
        })
      }
    } catch (error) {
      console.error("Error loading blog views:", error)
    }
  }
</script>
